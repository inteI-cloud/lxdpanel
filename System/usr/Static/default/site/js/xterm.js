(function(){var j=this,r=this.document;function i(){this._events=this._events||{}}i.prototype.addListener=function(A,B){this._events[A]=this._events[A]||[];this._events[A].push(B)};i.prototype.on=i.prototype.addListener;i.prototype.removeListener=function(B,C){if(!this._events[B]){return}var D=this._events[B],A=D.length;while(A--){if(D[A]===C||D[A].listener===C){D.splice(A,1);return}}};i.prototype.off=i.prototype.removeListener;i.prototype.removeAllListeners=function(A){if(this._events[A]){delete this._events[A]}};i.prototype.once=function(B,C){function A(){var D=Array.prototype.slice.call(arguments);this.removeListener(B,A);return C.apply(this,D)}A.listener=C;return this.on(B,A)};i.prototype.emit=function(D){if(!this._events[D]){return}var B=Array.prototype.slice.call(arguments,1),E=this._events[D],A=E.length,C=0;for(;C<A;C++){E[C].apply(this,B)}};i.prototype.listeners=function(A){return this._events[A]=this._events[A]||[]};function e(){i.call(this)}m(e,i);e.prototype.pipe=function(C,B){var G=this,F,A,E;function D(){G.removeListener("data",F);G.removeListener("error",A);G.removeListener("end",E);C.removeListener("error",A);C.removeListener("close",D)}G.on("data",F=function(H){C.write(H)});G.on("error",A=function(H){D();if(!this.listeners("error").length){throw H}});G.on("end",E=function(){C.end();D()});C.on("error",A);C.on("close",D);C.emit("pipe",G);return C};var z=0,h=1,s=2,k=3,g=4,q=5,u=6,p={type:"udk"};function v(B){var A=this;if(!(this instanceof v)){return new v(arguments[0],arguments[1],arguments[2])}e.call(this);if(typeof B==="number"){B={cols:arguments[0],rows:arguments[1],handler:arguments[2]}}B=B||{};f(o(v.defaults),function(D){if(B[D]==null){B[D]=v.options[D];if(v[D]!==v.defaults[D]){B[D]=v[D]}}A[D]=B[D]});if(B.colors.length===8){B.colors=B.colors.concat(v._colors.slice(8))}else{if(B.colors.length===16){B.colors=B.colors.concat(v._colors.slice(16))}else{if(B.colors.length===10){B.colors=B.colors.slice(0,-2).concat(v._colors.slice(8,-2),B.colors.slice(-2))}else{if(B.colors.length===18){B.colors=B.colors.slice(0,-2).concat(v._colors.slice(16,-2),B.colors.slice(-2))}}}}this.colors=B.colors;this.options=B;this.parent=B.body||B.parent||(r?r.getElementsByTagName("body")[0]:null);this.cols=B.cols||B.geometry[0];this.rows=B.rows||B.geometry[1];this.setRawMode;this.isTTY=true;this.isRaw=true;this.columns=this.cols;this.rows=this.rows;if(B.handler){this.on("data",B.handler)}this.ybase=0;this.ydisp=0;this.x=0;this.y=0;this.cursorState=0;this.cursorHidden=false;this.convertEol;this.state=0;this.queue="";this.scrollTop=0;this.scrollBottom=this.rows-1;this.applicationKeypad=false;this.applicationCursor=false;this.originMode=false;this.insertMode=false;this.wraparoundMode=false;this.normal=null;this.prefixMode=false;this.selectMode=false;this.visualMode=false;this.searchMode=false;this.searchDown;this.entry="";this.entryPrefix="Search: ";this._real;this._selected;this._textarea;this.charset=null;this.gcharset=null;this.glevel=0;this.charsets=[null];this.decLocator;this.x10Mouse;this.vt200Mouse;this.vt300Mouse;this.normalMouse;this.mouseEvents;this.sendFocus;this.utfMouse;this.sgrMouse;this.urxvtMouse;this.element;this.children;this.refreshStart;this.refreshEnd;this.savedX;this.savedY;this.savedCols;this.readable=true;this.writable=true;this.defAttr=(0<<18)|(257<<9)|(256<<0);this.curAttr=this.defAttr;this.params=[];this.currentParam=0;this.prefix="";this.postfix="";this.lines=[];var C=this.rows;while(C--){this.lines.push(this.blankLine())}this.tabs;this.setupStops()}m(v,e);v.tangoColors=["#2e3436","#cc0000","#4e9a06","#c4a000","#3465a4","#75507b","#06989a","#d3d7cf","#555753","#ef2929","#8ae234","#fce94f","#729fcf","#ad7fa8","#34e2e2","#eeeeec"];v.xtermColors=["#000000","#cd0000","#00cd00","#cdcd00","#0000ee","#cd00cd","#00cdcd","#e5e5e5","#7f7f7f","#ff0000","#00ff00","#ffff00","#5c5cff","#ff00ff","#00ffff","#ffffff"];v.colors=(function(){var A=v.tangoColors.slice(),E=[0,95,135,175,215,255],C;C=0;for(;C<216;C++){B(E[(C/36)%6|0],E[(C/6)%6|0],E[C%6])}C=0;for(;C<24;C++){E=8+C*10;B(E,E,E)}function B(H,G,F){A.push("#"+D(H)+D(G)+D(F))}function D(F){F=F.toString(16);return F.length<2?"0"+F:F}return A})();v.colors[256]="#000000";v.colors[257]="#f0f0f0";v._colors=v.colors.slice();v.vcolors=(function(){var C=[],A=v.colors,D=0,B;for(;D<256;D++){B=parseInt(A[D].substring(1),16);C.push([(B>>16)&255,(B>>8)&255,B&255])}return C})();v.defaults={colors:v.colors,convertEol:false,termName:"xterm",geometry:[80,24],cursorBlink:true,visualBell:false,popOnBell:false,scrollback:1000,screenKeys:false,debug:false,useStyle:false};v.options={};f(o(v.defaults),function(A){v[A]=v.defaults[A];v.options[A]=v.defaults[A]});v.focus=null;v.prototype.focus=function(){if(v.focus===this){return}if(v.focus){v.focus.blur()}if(this.sendFocus){this.send("\x1b[I")}this.showCursor();v.focus=this};v.prototype.blur=function(){if(v.focus!==this){return}this.cursorState=0;this.refresh(this.y,this.y);if(this.sendFocus){this.send("\x1b[O")}v.focus=null};v.prototype.initGlobal=function(){var A=this.document;
v._boundDocs=v._boundDocs||[];if(~c(v._boundDocs,A)){return}v._boundDocs.push(A);v.bindPaste(A);v.bindKeys(A);v.bindCopy(A);if(this.isMobile){this.fixMobile(A)}if(this.useStyle){v.insertStyle(A,this.colors[256],this.colors[257])}};v.bindPaste=function(A){var B=A.defaultView;l(B,"paste",function(D){var C=v.focus;if(!C){return}if(D.clipboardData){C.send(D.clipboardData.getData("text/plain"))}else{if(C.context.clipboardData){C.send(C.context.clipboardData.getData("Text"))}}C.element.contentEditable="inherit";return d(D)})};v.bindKeys=function(A){l(A,"keydown",function(B){if(!v.focus){return}var C=B.target||B.srcElement;if(!C){return}if(C===v.focus.element||C===v.focus.context||C===v.focus.document||C===v.focus.body||C===v._textarea||C===v.focus.parent){return v.focus.keyDown(B)}},true);l(A,"keypress",function(B){if(!v.focus){return}var C=B.target||B.srcElement;if(!C){return}if(C===v.focus.element||C===v.focus.context||C===v.focus.document||C===v.focus.body||C===v._textarea||C===v.focus.parent){return v.focus.keyPress(B)}},true);l(A,"mousedown",function(C){if(!v.focus){return}var B=C.target||C.srcElement;if(!B){return}do{if(B===v.focus.element){return}}while(B=B.parentNode);v.focus.blur()})};v.bindCopy=function(A){var B=A.defaultView;l(B,"copy",function(E){var D=v.focus;if(!D){return}if(!D._selected){return}var C=D.getCopyTextarea();var F=D.grabText(D._selected.x1,D._selected.x2,D._selected.y1,D._selected.y2);D.emit("copy",F);C.focus();C.textContent=F;C.value=F;C.setSelectionRange(0,F.length);b(function(){D.element.focus();D.focus()},1)})};v.prototype.fixMobile=function(A){var C=this;var B=A.createElement("textarea");B.style.position="absolute";B.style.left="-32000px";B.style.top="-32000px";B.style.width="0px";B.style.height="0px";B.style.opacity="0";B.style.backgroundColor="transparent";B.style.borderStyle="none";B.style.outlineStyle="none";B.autocapitalize="none";B.autocorrect="off";A.getElementsByTagName("body")[0].appendChild(B);v._textarea=B;b(function(){B.focus()},1000);if(this.isAndroid){l(B,"change",function(){var D=B.textContent||B.value;B.value="";B.textContent="";C.send(D+"\r")})}};v.insertStyle=function(A,D,B){var E=A.getElementById("term-style");if(E){return}var C=A.getElementsByTagName("head")[0];if(!C){return}var E=A.createElement("style");E.id="term-style";E.innerHTML=""+".terminal {\n"+"  float: left;\n"+"  border: "+D+" solid 5px;\n"+"  font-size: 11px;\n"+"  color: "+B+";\n"+"  background: "+D+";\n"+"}\n"+"\n"+".terminal-cursor {\n"+"  color: "+D+";\n"+"  background: "+B+";\n"+"}\n";C.insertBefore(E,C.firstChild)};v.prototype.open=function(C){var A=this,B=0,D;this.parent=C||this.parent;if(!this.parent){throw new Error("Terminal requires a parent element.")}this.context=this.parent.ownerDocument.defaultView;this.document=this.parent.ownerDocument;this.body=this.document.getElementsByTagName("body")[0];if(this.context.navigator&&this.context.navigator.userAgent){this.isMac=!!~this.context.navigator.userAgent.indexOf("Mac");this.isIpad=!!~this.context.navigator.userAgent.indexOf("iPad");this.isIphone=!!~this.context.navigator.userAgent.indexOf("iPhone");this.isAndroid=!!~this.context.navigator.userAgent.indexOf("Android");this.isMobile=this.isIpad||this.isIphone||this.isAndroid;this.isMSIE=!!~this.context.navigator.userAgent.indexOf("MSIE")}this.element=this.document.createElement("div");this.element.className="terminal";this.element.style.outline="none";this.element.setAttribute("tabindex",0);this.element.setAttribute("spellcheck","false");this.element.style.backgroundColor=this.colors[256];this.element.style.color=this.colors[257];this.children=[];for(;B<this.rows;B++){D=this.document.createElement("div");this.element.appendChild(D);this.children.push(D)}this.parent.appendChild(this.element);this.refresh(0,this.rows-1);if(!("useEvents" in this.options)||this.options.useEvents){this.initGlobal()}if(!("useFocus" in this.options)||this.options.useFocus){this.focus();this.startBlink();l(this.element,"focus",function(){A.focus();if(A.isMobile){v._textarea.focus()}});l(this.element,"mousedown",function(){A.focus()});l(this.element,"mousedown",function(F){var E=F.button!=null?+F.button:F.which!=null?F.which-1:null;if(A.isMSIE){E=E===1?0:E===4?1:E}if(E!==2){return}A.element.contentEditable="true";b(function(){A.element.contentEditable="inherit"},1)},true)}if(!("useMouse" in this.options)||this.options.useMouse){this.bindMouse()}if(!("useFocus" in this.options)||this.options.useFocus){b(function(){A.element.focus()},100)}if(v.brokenBold==null){v.brokenBold=x(this.document)}this.emit("open")};v.prototype.setRawMode=function(A){this.isRaw=!!A};v.prototype.bindMouse=function(){var B=this.element,J=this,D=32;var E="onmousewheel" in this.context?"mousewheel":"DOMMouseScroll";function H(L){var K,M;K=A(L);M=C(L);if(!M){return}I(K,M);switch(L.type){case"mousedown":D=K;break;case"mouseup":D=32;break;case E:break}}function G(L){var K=D,M;M=C(L);if(!M){return}K+=32;I(K,M)}function F(L,K){if(!J.utfMouse){if(K===255){return L.push(0)
}if(K>127){K=127}L.push(K)}else{if(K===2047){return L.push(0)}if(K<127){L.push(K)}else{if(K>2047){K=2047}L.push(192|(K>>6));L.push(128|(K&63))}}}function I(K,M){if(J.vt300Mouse){K&=3;M.x-=32;M.y-=32;var L="\x1b[24";if(K===0){L+="1"}else{if(K===1){L+="3"}else{if(K===2){L+="5"}else{if(K===3){return}else{L+="0"}}}}L+="~["+M.x+","+M.y+"]\r";J.send(L);return}if(J.decLocator){K&=3;M.x-=32;M.y-=32;if(K===0){K=2}else{if(K===1){K=4}else{if(K===2){K=6}else{if(K===3){K=3}}}}J.send("\x1b["+K+";"+(K===3?4:0)+";"+M.y+";"+M.x+";"+(M.page||0)+"&w");return}if(J.urxvtMouse){M.x-=32;M.y-=32;M.x++;M.y++;J.send("\x1b["+K+";"+M.x+";"+M.y+"M");return}if(J.sgrMouse){M.x-=32;M.y-=32;J.send("\x1b[<"+((K&3)===3?K&~3:K)+";"+M.x+";"+M.y+((K&3)===3?"m":"M"));return}var L=[];F(L,K);F(L,M.x);F(L,M.y);J.send("\x1b[M"+w.fromCharCode.apply(w,L))}function A(N){var M,K,P,O,L;switch(N.type){case"mousedown":M=N.button!=null?+N.button:N.which!=null?N.which-1:null;if(J.isMSIE){M=M===1?0:M===4?1:M}break;case"mouseup":M=3;break;case"DOMMouseScroll":M=N.detail<0?64:65;break;case"mousewheel":M=N.wheelDeltaY>0?64:65;break}K=N.shiftKey?4:0;P=N.metaKey?8:0;O=N.ctrlKey?16:0;L=K|P|O;if(J.vt200Mouse){L&=O}else{if(!J.normalMouse){L=0}}M=(32+(L<<2))+M;return M}function C(O){var K,P,L,N,M;if(O.pageX==null){return}K=O.pageX;P=O.pageY;M=J.element;while(M&&M!==J.document.documentElement){K-=M.offsetLeft;P-=M.offsetTop;M="offsetParent" in M?M.offsetParent:M.parentNode}L=J.element.clientWidth;N=J.element.clientHeight;K=Math.round((K/L)*J.cols);P=Math.round((P/N)*J.rows);if(K<0){K=0}if(K>J.cols){K=J.cols}if(P<0){P=0}if(P>J.rows){P=J.rows}K+=32;P+=32;return{x:K,y:P,type:O.type===E?"mousewheel":O.type}}l(B,"mousedown",function(L){if(!J.mouseEvents){return}H(L);J.focus();if(J.normalMouse){l(J.document,"mousemove",G)}if(!J.x10Mouse){l(J.document,"mouseup",function K(M){H(M);if(J.normalMouse){y(J.document,"mousemove",G)}y(J.document,"mouseup",K);return d(M)})}return d(L)});l(B,E,function(K){if(!J.mouseEvents){return}if(J.x10Mouse||J.vt300Mouse||J.decLocator){return}H(K);return d(K)});l(B,E,function(K){if(J.mouseEvents){return}if(J.applicationKeypad){return}if(K.type==="DOMMouseScroll"){J.scrollDisp(K.detail<0?-5:5)}else{J.scrollDisp(K.wheelDeltaY>0?-5:5)}return d(K)})};v.prototype.close=v.prototype.destroySoon=v.prototype.destroy=function(){if(this.destroyed){return}if(this._blink){clearInterval(this._blink);delete this._blink}this.readable=false;this.writable=false;this.destroyed=true;this._events={};this.handler=function(){};this.write=function(){};this.end=function(){};if(this.element.parentNode){this.element.parentNode.removeChild(this.element)}this.emit("end");this.emit("close");this.emit("finish");this.emit("destroy")};v.prototype.refresh=function(D,F){var M,L,J,P,G,B,C,I,K,H,A,E,O,N;if(F-D>=this.rows/2){N=this.element.parentNode;if(N){N.removeChild(this.element)}}C=this.cols;L=D;if(F>=this.lines.length){this.log("`end` is too large. Most likely a bad CSR.");F=this.lines.length-1}for(;L<=F;L++){O=L+this.ydisp;P=this.lines[O];G="";if(L===this.y&&this.cursorState&&(this.ydisp===this.ybase||this.selectMode)&&!this.cursorHidden){M=this.x}else{M=-1}K=this.defAttr;J=0;for(;J<C;J++){I=P[J][0];B=P[J][1];if(J===M){I=-1}if(I!==K){if(K!==this.defAttr){G+="</span>"}if(I!==this.defAttr){if(I===-1){G+='<span class="reverse-video terminal-cursor">'}else{G+='<span style="';H=I&511;A=(I>>9)&511;E=I>>18;if(E&1){if(!v.brokenBold){G+="font-weight:bold;"}if(A<8){A+=8}}if(E&2){G+="text-decoration:underline;"}if(E&4){if(E&2){G=G.slice(0,-1);G+=" blink;"}else{G+="text-decoration:blink;"}}if(E&8){H=(I>>9)&511;A=I&511;if((E&1)&&A<8){A+=8}}if(E&16){G+="visibility:hidden;"}if(H!==256){G+="background-color:"+this.colors[H]+";"}if(A!==257){G+="color:"+this.colors[A]+";"}G+='">'}}}switch(B){case"&":G+="&amp;";break;case"<":G+="&lt;";break;case">":G+="&gt;";break;default:if(B<=" "){G+="&nbsp;"}else{if(t(B)){J++}G+=B}break}K=I}if(K!==this.defAttr){G+="</span>"}this.children[L].innerHTML=G}if(N){N.appendChild(this.element)}};v.prototype._cursorBlink=function(){if(v.focus!==this){return}this.cursorState^=1;this.refresh(this.y,this.y)};v.prototype.showCursor=function(){if(!this.cursorState){this.cursorState=1;this.refresh(this.y,this.y)}else{}};v.prototype.startBlink=function(){if(!this.cursorBlink){return}var A=this;this._blinker=function(){A._cursorBlink()};this._blink=a(this._blinker,500)};v.prototype.refreshBlink=function(){if(!this.cursorBlink||!this._blink){return}clearInterval(this._blink);this._blink=a(this._blinker,500)};v.prototype.scroll=function(){var A;if(++this.ybase===this.scrollback){this.ybase=this.ybase/2|0;this.lines=this.lines.slice(-(this.ybase+this.rows)+1)}this.ydisp=this.ybase;A=this.ybase+this.rows-1;A-=this.rows-1-this.scrollBottom;if(A===this.lines.length){this.lines.push(this.blankLine())}else{this.lines.splice(A,0,this.blankLine())}if(this.scrollTop!==0){if(this.ybase!==0){this.ybase--;this.ydisp=this.ybase}this.lines.splice(this.ybase+this.scrollTop,1)}this.updateRange(this.scrollTop);
this.updateRange(this.scrollBottom)};v.prototype.scrollDisp=function(A){this.ydisp+=A;if(this.ydisp>this.ybase){this.ydisp=this.ybase}else{if(this.ydisp<0){this.ydisp=0}}this.refresh(0,this.rows-1)};v.prototype.write=function(G){var A=G.length,C=0,B,E,D;this.refreshStart=this.y;this.refreshEnd=this.y;if(this.ybase!==this.ydisp){this.ydisp=this.ybase;this.maxRange()}for(;C<A;C++,this.lch=D){D=G[C];switch(this.state){case z:switch(D){case"\x07":this.bell();break;case"\n":case"\x0b":case"\x0c":if(this.convertEol){this.x=0}this.y++;if(this.y>this.scrollBottom){this.y--;this.scroll()}break;case"\r":this.x=0;break;case"\x08":if(this.x>0){this.x--}break;case"\t":this.x=this.nextStop();break;case"\x0e":this.setgLevel(1);break;case"\x0f":this.setgLevel(0);break;case"\x1b":this.state=h;break;default:if(D>=" "){if(this.charset&&this.charset[D]){D=this.charset[D]}if(this.x>=this.cols){this.x=0;this.y++;if(this.y>this.scrollBottom){this.y--;this.scroll()}}this.lines[this.y+this.ybase][this.x]=[this.curAttr,D];this.x++;this.updateRange(this.y);if(t(D)){B=this.y+this.ybase;if(this.cols<2||this.x>=this.cols){this.lines[B][this.x-1]=[this.curAttr," "];break}this.lines[B][this.x]=[this.curAttr," "];this.x++}}break}break;case h:switch(D){case"[":this.params=[];this.currentParam=0;this.state=s;break;case"]":this.params=[];this.currentParam=0;this.state=k;break;case"P":this.params=[];this.prefix="";this.currentParam="";this.state=q;break;case"_":this.state=u;break;case"^":this.state=u;break;case"c":this.reset();break;case"E":this.x=0;case"D":this.index();break;case"M":this.reverseIndex();break;case"%":this.setgLevel(0);this.setgCharset(0,v.charsets.US);this.state=z;C++;break;case"(":case")":case"*":case"+":case"-":case".":switch(D){case"(":this.gcharset=0;break;case")":this.gcharset=1;break;case"*":this.gcharset=2;break;case"+":this.gcharset=3;break;case"-":this.gcharset=1;break;case".":this.gcharset=2;break}this.state=g;break;case"/":this.gcharset=3;this.state=g;C--;break;case"N":break;case"O":break;case"n":this.setgLevel(2);break;case"o":this.setgLevel(3);break;case"|":this.setgLevel(3);break;case"}":this.setgLevel(2);break;case"~":this.setgLevel(1);break;case"7":this.saveCursor();this.state=z;break;case"8":this.restoreCursor();this.state=z;break;case"#":this.state=z;C++;break;case"H":this.tabSet();break;case"=":this.log("Serial port requested application keypad.");this.applicationKeypad=true;this.state=z;break;case">":this.log("Switching back to normal keypad.");this.applicationKeypad=false;this.state=z;break;default:this.state=z;this.error("Unknown ESC control: %s.",D);break}break;case g:switch(D){case"0":E=v.charsets.SCLD;break;case"A":E=v.charsets.UK;break;case"B":E=v.charsets.US;break;case"4":E=v.charsets.Dutch;break;case"C":case"5":E=v.charsets.Finnish;break;case"R":E=v.charsets.French;break;case"Q":E=v.charsets.FrenchCanadian;break;case"K":E=v.charsets.German;break;case"Y":E=v.charsets.Italian;break;case"E":case"6":E=v.charsets.NorwegianDanish;break;case"Z":E=v.charsets.Spanish;break;case"H":case"7":E=v.charsets.Swedish;break;case"=":E=v.charsets.Swiss;break;case"/":E=v.charsets.ISOLatin;C++;break;default:E=v.charsets.US;break}this.setgCharset(this.gcharset,E);this.gcharset=null;this.state=z;break;case k:if((this.lch==="\x1b"&&D==="\\")||D==="\x07"){if(this.lch==="\x1b"){if(typeof this.currentParam==="string"){this.currentParam=this.currentParam.slice(0,-1)}else{if(typeof this.currentParam=="number"){this.currentParam=(this.currentParam-("\x1b".charCodeAt(0)-48))/10}}}this.params.push(this.currentParam);switch(this.params[0]){case 0:case 1:case 2:if(this.params[1]){this.title=this.params[1];this.handleTitle(this.title)}break;case 3:break;case 4:case 5:break;case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:break;case 46:break;case 50:break;case 51:break;case 52:break;case 104:case 105:case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:case 118:break}this.params=[];this.currentParam=0;this.state=z}else{if(!this.params.length){if(D>="0"&&D<="9"){this.currentParam=this.currentParam*10+D.charCodeAt(0)-48}else{if(D===";"){this.params.push(this.currentParam);this.currentParam=""}}}else{this.currentParam+=D}}break;case s:if(D==="?"||D===">"||D==="!"){this.prefix=D;break}if(D>="0"&&D<="9"){this.currentParam=this.currentParam*10+D.charCodeAt(0)-48;break}if(D==="$"||D==='"'||D===" "||D==="'"){this.postfix=D;break}this.params.push(this.currentParam);this.currentParam=0;if(D===";"){break}this.state=z;switch(D){case"A":this.cursorUp(this.params);break;case"B":this.cursorDown(this.params);break;case"C":this.cursorForward(this.params);break;case"D":this.cursorBackward(this.params);break;case"H":this.cursorPos(this.params);break;case"J":this.eraseInDisplay(this.params);break;case"K":this.eraseInLine(this.params);break;case"m":if(!this.prefix){this.charAttributes(this.params)}break;case"n":if(!this.prefix){this.deviceStatus(this.params)}break;case"@":this.insertChars(this.params);break;
case"E":this.cursorNextLine(this.params);break;case"F":this.cursorPrecedingLine(this.params);break;case"G":this.cursorCharAbsolute(this.params);break;case"L":this.insertLines(this.params);break;case"M":this.deleteLines(this.params);break;case"P":this.deleteChars(this.params);break;case"X":this.eraseChars(this.params);break;case"`":this.charPosAbsolute(this.params);break;case"a":this.HPositionRelative(this.params);break;case"c":this.sendDeviceAttributes(this.params);break;case"d":this.linePosAbsolute(this.params);break;case"e":this.VPositionRelative(this.params);break;case"f":this.HVPosition(this.params);break;case"h":this.setMode(this.params);break;case"l":this.resetMode(this.params);break;case"r":this.setScrollRegion(this.params);break;case"s":this.saveCursor(this.params);break;case"u":this.restoreCursor(this.params);break;case"I":this.cursorForwardTab(this.params);break;case"S":this.scrollUp(this.params);break;case"T":if(this.params.length<2&&!this.prefix){this.scrollDown(this.params)}break;case"Z":this.cursorBackwardTab(this.params);break;case"b":this.repeatPrecedingCharacter(this.params);break;case"g":this.tabClear(this.params);break;case"p":switch(this.prefix){case"!":this.softReset(this.params);break}break;default:this.error("Unknown CSI code: %s.",D);break}this.prefix="";this.postfix="";break;case q:if((this.lch==="\x1b"&&D==="\\")||D==="\x07"){if(this.prefix==="tmux;\x1b"){if(D==="\x07"){this.currentParam+=D;continue}}if(this.lch==="\x1b"){if(typeof this.currentParam==="string"){this.currentParam=this.currentParam.slice(0,-1)}else{if(typeof this.currentParam=="number"){this.currentParam=(this.currentParam-("\x1b".charCodeAt(0)-48))/10}}}this.params.push(this.currentParam);var H=this.params[this.params.length-1];switch(this.prefix){case p:this.emit("udk",{clearAll:this.params[0]===0,eraseBelow:this.params[0]===1,lockKeys:this.params[1]===0,dontLockKeys:this.params[1]===1,keyList:(this.params[2]+"").split(";").map(function(I){I=I.split("/");return{keyCode:I[0],hexKeyValue:I[1]}})});break;case"$q":var F=0;switch(H){case'"q':H='0"q';F=1;break;case'"p':H='61;0"p';F=1;break;case"r":H=""+(this.scrollTop+1)+";"+(this.scrollBottom+1)+"r";F=1;break;case"m":F=0;break;default:this.error("Unknown DCS Pt: %s.",H);F=0;break}this.send("\x1bP"+F+"$r"+H+"\x1b\\");break;case"+p":this.emit("set terminfo",{name:this.params[0]});break;case"+q":var F=false;this.send("\x1bP"+ +F+"+r"+H+"\x1b\\");break;case"tmux;\x1b":this.emit("passthrough",H);break;default:this.error("Unknown DCS prefix: %s.",H);break}this.currentParam=0;this.prefix="";this.state=z}else{this.currentParam+=D;if(!this.prefix){if(/^\d*;\d*\|/.test(this.currentParam)){this.prefix=p;this.params=this.currentParam.split(/[;|]/).map(function(I){if(!I.length){return 0}return +I}).slice(0,-1);this.currentParam=""}else{if(/^[$+][a-zA-Z]/.test(this.currentParam)||/^\w+;\x1b/.test(this.currentParam)){this.prefix=this.currentParam;this.currentParam=""}}}}break;case u:if((this.lch==="\x1b"&&D==="\\")||D==="\x07"){this.state=z}break}}this.updateRange(this.y);this.refresh(this.refreshStart,this.refreshEnd);return true};v.prototype.writeln=function(A){return this.write(A+"\r\n")};v.prototype.end=function(B){var A=true;if(B){A=this.write(B)}this.destroySoon();return A};v.prototype.resume=function(){};v.prototype.pause=function(){};v.prototype.keyDown=function(C){var A=this,B;switch(C.keyCode){case 8:if(C.altKey){B="\x17";break}if(C.shiftKey){B="\x08";break}B="\x7f";break;case 9:if(C.shiftKey){B="\x1b[Z";break}B="\t";break;case 13:B="\r";break;case 27:B="\x1b";break;case 32:B="\x20";break;case 37:if(this.applicationCursor){B="\x1bOD";break}if(C.ctrlKey){B="\x1b[5D";break}B="\x1b[D";break;case 39:if(this.applicationCursor){B="\x1bOC";break}if(C.ctrlKey){B="\x1b[5C";break}B="\x1b[C";break;case 38:if(this.applicationCursor){B="\x1bOA";break}if(C.ctrlKey){this.scrollDisp(-1);return d(C)}else{B="\x1b[A"}break;case 40:if(this.applicationCursor){B="\x1bOB";break}if(C.ctrlKey){this.scrollDisp(1);return d(C)}else{B="\x1b[B"}break;case 46:B="\x1b[3~";break;case 45:B="\x1b[2~";break;case 36:if(this.applicationKeypad){B="\x1bOH";break}B="\x1bOH";break;case 35:if(this.applicationKeypad){B="\x1bOF";break}B="\x1bOF";break;case 33:if(C.shiftKey){this.scrollDisp(-(this.rows-1));return d(C)}else{B="\x1b[5~"}break;case 34:if(C.shiftKey){this.scrollDisp(this.rows-1);return d(C)}else{B="\x1b[6~"}break;case 112:B="\x1bOP";break;case 113:B="\x1bOQ";break;case 114:B="\x1bOR";break;case 115:B="\x1bOS";break;case 116:B="\x1b[15~";break;case 117:B="\x1b[17~";break;case 118:B="\x1b[18~";break;case 119:B="\x1b[19~";break;case 120:B="\x1b[20~";break;case 121:B="\x1b[21~";break;case 122:B="\x1b[23~";break;case 123:B="\x1b[24~";break;default:if(C.ctrlKey){if(C.keyCode>=65&&C.keyCode<=90){if(this.screenKeys){if(!this.prefixMode&&!this.selectMode&&C.keyCode===65){this.enterPrefix();return d(C)}}if(this.prefixMode&&C.keyCode===86){this.leavePrefix();return}if((this.prefixMode||this.selectMode)&&C.keyCode===67){if(this.visualMode){b(function(){A.leaveVisual()
},1)}return}B=w.fromCharCode(C.keyCode-64)}else{if(C.keyCode===32){B=w.fromCharCode(0)}else{if(C.keyCode>=51&&C.keyCode<=55){B=w.fromCharCode(C.keyCode-51+27)}else{if(C.keyCode===56){B=w.fromCharCode(127)}else{if(C.keyCode===219){B=w.fromCharCode(27)}else{if(C.keyCode===221){B=w.fromCharCode(29)}}}}}}}else{if(C.altKey){if(C.keyCode>=65&&C.keyCode<=90){B="\x1b"+w.fromCharCode(C.keyCode+32)}else{if(C.keyCode===192){B="\x1b`"}else{if(C.keyCode>=48&&C.keyCode<=57){B="\x1b"+(C.keyCode-48)}}}}}break}if(!B){return true}if(this.prefixMode){this.leavePrefix();return d(C)}if(this.selectMode){this.keySelect(C,B);return d(C)}this.emit("keydown",C);this.emit("key",B,C);this.showCursor();this.handler(B);return d(C)};v.prototype.setgLevel=function(A){this.glevel=A;this.charset=this.charsets[A]};v.prototype.setgCharset=function(A,B){this.charsets[A]=B;if(this.glevel===A){this.charset=B}};v.prototype.keyPress=function(B){var A;d(B);if(B.charCode){A=B.charCode}else{if(B.which==null){A=B.keyCode}else{if(B.which!==0&&B.charCode!==0){A=B.which}else{return false}}}if(!A||B.ctrlKey||B.altKey||B.metaKey){return false}A=w.fromCharCode(A);if(this.prefixMode){this.leavePrefix();this.keyPrefix(B,A);return false}if(this.selectMode){this.keySelect(B,A);return false}this.emit("keypress",A,B);this.emit("key",A,B);this.showCursor();this.handler(A);return false};v.prototype.send=function(B){var A=this;if(!this.queue){b(function(){A.handler(A.queue);A.queue=""},1)}this.queue+=B};v.prototype.bell=function(){this.emit("bell");if(!this.visualBell){return}var A=this;this.element.style.borderColor="white";b(function(){A.element.style.borderColor=""},10);if(this.popOnBell){this.focus()}};v.prototype.log=function(){if(!this.debug){return}if(!this.context.console||!this.context.console.log){return}var A=Array.prototype.slice.call(arguments);this.context.console.log.apply(this.context.console,A)};v.prototype.error=function(){if(!this.debug){return}if(!this.context.console||!this.context.console.error){return}var A=Array.prototype.slice.call(arguments);this.context.console.error.apply(this.context.console,A)};v.prototype.resize=function(A,G){var B,F,D,C,E;if(A<1){A=1}if(G<1){G=1}C=this.cols;if(C<A){E=[this.defAttr," "];D=this.lines.length;while(D--){while(this.lines[D].length<A){this.lines[D].push(E)}}}else{if(C>A){D=this.lines.length;while(D--){while(this.lines[D].length>A){this.lines[D].pop()}}}}this.setupStops(C);this.cols=A;this.columns=A;C=this.rows;if(C<G){F=this.element;while(C++<G){if(this.lines.length<G+this.ybase){this.lines.push(this.blankLine())}if(this.children.length<G){B=this.document.createElement("div");F.appendChild(B);this.children.push(B)}}}else{if(C>G){while(C-->G){if(this.lines.length>G+this.ybase){this.lines.pop()}if(this.children.length>G){F=this.children.pop();if(!F){continue}F.parentNode.removeChild(F)}}}}this.rows=G;if(this.y>=G){this.y=G-1}if(this.x>=A){this.x=A-1}this.scrollTop=0;this.scrollBottom=G-1;this.refresh(0,this.rows-1);this.normal=null;this.emit("resize")};v.prototype.updateRange=function(A){if(A<this.refreshStart){this.refreshStart=A}if(A>this.refreshEnd){this.refreshEnd=A}};v.prototype.maxRange=function(){this.refreshStart=0;this.refreshEnd=this.rows-1};v.prototype.setupStops=function(A){if(A!=null){if(!this.tabs[A]){A=this.prevStop(A)}}else{this.tabs={};A=0}for(;A<this.cols;A+=8){this.tabs[A]=true}};v.prototype.prevStop=function(A){if(A==null){A=this.x}while(!this.tabs[--A]&&A>0){}return A>=this.cols?this.cols-1:A<0?0:A};v.prototype.nextStop=function(A){if(A==null){A=this.x}while(!this.tabs[++A]&&A<this.cols){}return A>=this.cols?this.cols-1:A<0?0:A};v.prototype.eraseAttr=function(){return(this.defAttr&~511)|(this.curAttr&511)};v.prototype.eraseRight=function(A,D){var B=this.lines[this.ybase+D],C=[this.eraseAttr()," "];for(;A<this.cols;A++){B[A]=C}this.updateRange(D)};v.prototype.eraseLeft=function(A,D){var B=this.lines[this.ybase+D],C=[this.eraseAttr()," "];A++;while(A--){B[A]=C}this.updateRange(D)};v.prototype.eraseLine=function(A){this.eraseRight(0,A)};v.prototype.blankLine=function(E){var A=E?this.eraseAttr():this.defAttr;var D=[A," "],B=[],C=0;for(;C<this.cols;C++){B[C]=D}return B};v.prototype.ch=function(A){return A?[this.eraseAttr()," "]:[this.defAttr," "]};v.prototype.is=function(B){var A=this.termName;return(A+"").indexOf(B)===0};v.prototype.handler=function(A){this.emit("data",A)};v.prototype.handleTitle=function(A){this.emit("title",A)};v.prototype.index=function(){this.y++;if(this.y>this.scrollBottom){this.y--;this.scroll()}this.state=z};v.prototype.reverseIndex=function(){var A;this.y--;if(this.y<this.scrollTop){this.y++;this.lines.splice(this.y+this.ybase,0,this.blankLine(true));A=this.rows-1-this.scrollBottom;this.lines.splice(this.rows-1+this.ybase-A+1,1);this.updateRange(this.scrollTop);this.updateRange(this.scrollBottom)}this.state=z};v.prototype.reset=function(){this.options.rows=this.rows;this.options.cols=this.cols;v.call(this,this.options);this.refresh(0,this.rows-1)};v.prototype.tabSet=function(){this.tabs[this.x]=true;
this.state=z};v.prototype.cursorUp=function(B){var A=B[0];if(A<1){A=1}this.y-=A;if(this.y<0){this.y=0}};v.prototype.cursorDown=function(B){var A=B[0];if(A<1){A=1}this.y+=A;if(this.y>=this.rows){this.y=this.rows-1}};v.prototype.cursorForward=function(B){var A=B[0];if(A<1){A=1}this.x+=A;if(this.x>=this.cols){this.x=this.cols-1}};v.prototype.cursorBackward=function(B){var A=B[0];if(A<1){A=1}this.x-=A;if(this.x<0){this.x=0}};v.prototype.cursorPos=function(C){var B,A;B=C[0]-1;if(C.length>=2){A=C[1]-1}else{A=0}if(B<0){B=0}else{if(B>=this.rows){B=this.rows-1}}if(A<0){A=0}else{if(A>=this.cols){A=this.cols-1}}this.x=A;this.y=B};v.prototype.eraseInDisplay=function(B){var A;switch(B[0]){case 0:this.eraseRight(this.x,this.y);A=this.y+1;for(;A<this.rows;A++){this.eraseLine(A)}break;case 1:this.eraseLeft(this.x,this.y);A=this.y;while(A--){this.eraseLine(A)}break;case 2:A=this.rows;while(A--){this.eraseLine(A)}break;case 3:break}};v.prototype.eraseInLine=function(A){switch(A[0]){case 0:this.eraseRight(this.x,this.y);break;case 1:this.eraseLeft(this.x,this.y);break;case 2:this.eraseLine(this.y);break}};v.prototype.charAttributes=function(G){if(G.length===1&&G[0]===0){this.curAttr=this.defAttr;return}var C=G.length,E=0,B=this.curAttr>>18,A=(this.curAttr>>9)&511,D=this.curAttr&511,F;for(;E<C;E++){F=G[E];if(F>=30&&F<=37){A=F-30}else{if(F>=40&&F<=47){D=F-40}else{if(F>=90&&F<=97){F+=8;A=F-90}else{if(F>=100&&F<=107){F+=8;D=F-100}else{if(F===0){B=this.defAttr>>18;A=(this.defAttr>>9)&511;D=this.defAttr&511}else{if(F===1){B|=1}else{if(F===4){B|=2}else{if(F===5){B|=4}else{if(F===7){B|=8}else{if(F===8){B|=16}else{if(F===22){B&=~1}else{if(F===24){B&=~2}else{if(F===25){B&=~4}else{if(F===27){B&=~8}else{if(F===28){B&=~16}else{if(F===39){A=(this.defAttr>>9)&511}else{if(F===49){D=this.defAttr&511}else{if(F===38){if(G[E+1]===2){E+=2;A=n(G[E]&255,G[E+1]&255,G[E+2]&255);if(A===-1){A=511}E+=2}else{if(G[E+1]===5){E+=2;F=G[E]&255;A=F}}}else{if(F===48){if(G[E+1]===2){E+=2;D=n(G[E]&255,G[E+1]&255,G[E+2]&255);if(D===-1){D=511}E+=2}else{if(G[E+1]===5){E+=2;F=G[E]&255;D=F}}}else{if(F===100){A=(this.defAttr>>9)&511;D=this.defAttr&511}else{this.error("Unknown SGR attribute: %d.",F)}}}}}}}}}}}}}}}}}}}}}this.curAttr=(B<<18)|(A<<9)|D};v.prototype.deviceStatus=function(A){if(!this.prefix){switch(A[0]){case 5:this.send("\x1b[0n");break;case 6:this.send("\x1b["+(this.y+1)+";"+(this.x+1)+"R");break}}else{if(this.prefix==="?"){switch(A[0]){case 6:this.send("\x1b[?"+(this.y+1)+";"+(this.x+1)+"R");break;case 15:break;case 25:break;case 26:break;case 53:break}}}};v.prototype.insertChars=function(E){var D,C,A,B;D=E[0];if(D<1){D=1}C=this.y+this.ybase;A=this.x;B=[this.eraseAttr()," "];while(D--&&A<this.cols){this.lines[C].splice(A++,0,B);this.lines[C].pop()}};v.prototype.cursorNextLine=function(B){var A=B[0];if(A<1){A=1}this.y+=A;if(this.y>=this.rows){this.y=this.rows-1}this.x=0};v.prototype.cursorPrecedingLine=function(B){var A=B[0];if(A<1){A=1}this.y-=A;if(this.y<0){this.y=0}this.x=0};v.prototype.cursorCharAbsolute=function(B){var A=B[0];if(A<1){A=1}this.x=A-1};v.prototype.insertLines=function(D){var C,B,A;C=D[0];if(C<1){C=1}B=this.y+this.ybase;A=this.rows-1-this.scrollBottom;A=this.rows-1+this.ybase-A+1;while(C--){this.lines.splice(B,0,this.blankLine(true));this.lines.splice(A,1)}this.updateRange(this.y);this.updateRange(this.scrollBottom)};v.prototype.deleteLines=function(D){var C,B,A;C=D[0];if(C<1){C=1}B=this.y+this.ybase;A=this.rows-1-this.scrollBottom;A=this.rows-1+this.ybase-A;while(C--){this.lines.splice(A+1,0,this.blankLine(true));this.lines.splice(B,1)}this.updateRange(this.y);this.updateRange(this.scrollBottom)};v.prototype.deleteChars=function(D){var C,B,A;C=D[0];if(C<1){C=1}B=this.y+this.ybase;A=[this.eraseAttr()," "];while(C--){this.lines[B].splice(this.x,1);this.lines[B].push(A)}};v.prototype.eraseChars=function(E){var D,C,A,B;D=E[0];if(D<1){D=1}C=this.y+this.ybase;A=this.x;B=[this.eraseAttr()," "];while(D--&&A<this.cols){this.lines[C][A++]=B}};v.prototype.charPosAbsolute=function(B){var A=B[0];if(A<1){A=1}this.x=A-1;if(this.x>=this.cols){this.x=this.cols-1}};v.prototype.HPositionRelative=function(B){var A=B[0];if(A<1){A=1}this.x+=A;if(this.x>=this.cols){this.x=this.cols-1}};v.prototype.sendDeviceAttributes=function(A){if(A[0]>0){return}if(!this.prefix){if(this.is("xterm")||this.is("rxvt-unicode")||this.is("screen")){this.send("\x1b[?1;2c")}else{if(this.is("linux")){this.send("\x1b[?6c")}}}else{if(this.prefix===">"){if(this.is("xterm")){this.send("\x1b[>0;276;0c")}else{if(this.is("rxvt-unicode")){this.send("\x1b[>85;95;0c")}else{if(this.is("linux")){this.send(A[0]+"c")}else{if(this.is("screen")){this.send("\x1b[>83;40003;0c")}}}}}}};v.prototype.linePosAbsolute=function(B){var A=B[0];if(A<1){A=1}this.y=A-1;if(this.y>=this.rows){this.y=this.rows-1}};v.prototype.VPositionRelative=function(B){var A=B[0];if(A<1){A=1}this.y+=A;if(this.y>=this.rows){this.y=this.rows-1}};v.prototype.HVPosition=function(A){if(A[0]<1){A[0]=1}if(A[1]<1){A[1]=1}this.y=A[0]-1;if(this.y>=this.rows){this.y=this.rows-1
}this.x=A[1]-1;if(this.x>=this.cols){this.x=this.cols-1}};v.prototype.setMode=function(D){if(typeof D==="object"){var A=D.length,B=0;for(;B<A;B++){this.setMode(D[B])}return}if(!this.prefix){switch(D){case 4:this.insertMode=true;break;case 20:break}}else{if(this.prefix==="?"){switch(D){case 1:this.applicationCursor=true;break;case 2:this.setgCharset(0,v.charsets.US);this.setgCharset(1,v.charsets.US);this.setgCharset(2,v.charsets.US);this.setgCharset(3,v.charsets.US);break;case 3:this.savedCols=this.cols;this.resize(132,this.rows);break;case 6:this.originMode=true;break;case 7:this.wraparoundMode=true;break;case 12:break;case 66:this.log("Serial port requested application keypad.");this.applicationKeypad=true;break;case 9:case 1000:case 1002:case 1003:this.x10Mouse=D===9;this.vt200Mouse=D===1000;this.normalMouse=D>1000;this.mouseEvents=true;this.element.style.cursor="default";this.log("Binding to mouse events.");break;case 1004:this.sendFocus=true;break;case 1005:this.utfMouse=true;break;case 1006:this.sgrMouse=true;break;case 1015:this.urxvtMouse=true;break;case 25:this.cursorHidden=false;break;case 1049:case 47:case 1047:if(!this.normal){var C={lines:this.lines,ybase:this.ybase,ydisp:this.ydisp,x:this.x,y:this.y,scrollTop:this.scrollTop,scrollBottom:this.scrollBottom,tabs:this.tabs};this.reset();this.normal=C;this.showCursor()}break}}}};v.prototype.resetMode=function(C){if(typeof C==="object"){var A=C.length,B=0;for(;B<A;B++){this.resetMode(C[B])}return}if(!this.prefix){switch(C){case 4:this.insertMode=false;break;case 20:break}}else{if(this.prefix==="?"){switch(C){case 1:this.applicationCursor=false;break;case 3:if(this.cols===132&&this.savedCols){this.resize(this.savedCols,this.rows)}delete this.savedCols;break;case 6:this.originMode=false;break;case 7:this.wraparoundMode=false;break;case 12:break;case 66:this.log("Switching back to normal keypad.");this.applicationKeypad=false;break;case 9:case 1000:case 1002:case 1003:this.x10Mouse=false;this.vt200Mouse=false;this.normalMouse=false;this.mouseEvents=false;this.element.style.cursor="";break;case 1004:this.sendFocus=false;break;case 1005:this.utfMouse=false;break;case 1006:this.sgrMouse=false;break;case 1015:this.urxvtMouse=false;break;case 25:this.cursorHidden=true;break;case 1049:case 47:case 1047:if(this.normal){this.lines=this.normal.lines;this.ybase=this.normal.ybase;this.ydisp=this.normal.ydisp;this.x=this.normal.x;this.y=this.normal.y;this.scrollTop=this.normal.scrollTop;this.scrollBottom=this.normal.scrollBottom;this.tabs=this.normal.tabs;this.normal=null;this.refresh(0,this.rows-1);this.showCursor()}break}}}};v.prototype.setScrollRegion=function(A){if(this.prefix){return}this.scrollTop=(A[0]||1)-1;this.scrollBottom=(A[1]||this.rows)-1;this.x=0;this.y=0};v.prototype.saveCursor=function(A){this.savedX=this.x;this.savedY=this.y};v.prototype.restoreCursor=function(A){this.x=this.savedX||0;this.y=this.savedY||0};v.prototype.cursorForwardTab=function(B){var A=B[0]||1;while(A--){this.x=this.nextStop()}};v.prototype.scrollUp=function(B){var A=B[0]||1;while(A--){this.lines.splice(this.ybase+this.scrollTop,1);this.lines.splice(this.ybase+this.scrollBottom,0,this.blankLine())}this.updateRange(this.scrollTop);this.updateRange(this.scrollBottom)};v.prototype.scrollDown=function(B){var A=B[0]||1;while(A--){this.lines.splice(this.ybase+this.scrollBottom,1);this.lines.splice(this.ybase+this.scrollTop,0,this.blankLine())}this.updateRange(this.scrollTop);this.updateRange(this.scrollBottom)};v.prototype.initMouseTracking=function(A){};v.prototype.resetTitleModes=function(A){};v.prototype.cursorBackwardTab=function(B){var A=B[0]||1;while(A--){this.x=this.prevStop()}};v.prototype.repeatPrecedingCharacter=function(D){var C=D[0]||1,A=this.lines[this.ybase+this.y],B=A[this.x-1]||[this.defAttr," "];while(C--){A[this.x++]=B}};v.prototype.tabClear=function(B){var A=B[0];if(A<=0){delete this.tabs[this.x]}else{if(A===3){this.tabs={}}}};v.prototype.mediaCopy=function(A){};v.prototype.setResources=function(A){};v.prototype.disableModifiers=function(A){};v.prototype.setPointerMode=function(A){};v.prototype.softReset=function(A){this.cursorHidden=false;this.insertMode=false;this.originMode=false;this.wraparoundMode=false;this.applicationKeypad=false;this.applicationCursor=false;this.scrollTop=0;this.scrollBottom=this.rows-1;this.curAttr=this.defAttr;this.x=this.y=0;this.charset=null;this.glevel=0;this.charsets=[null]};v.prototype.requestAnsiMode=function(A){};v.prototype.requestPrivateMode=function(A){};v.prototype.setConformanceLevel=function(A){};v.prototype.loadLEDs=function(A){};v.prototype.setCursorStyle=function(A){};v.prototype.setCharProtectionAttr=function(A){};v.prototype.restorePrivateValues=function(A){};v.prototype.setAttrInRectangle=function(H){var F=H[0],D=H[1],B=H[2],G=H[3],A=H[4];var C,E;for(;F<B+1;F++){C=this.lines[this.ybase+F];for(E=D;E<G;E++){C[E]=[A,C[E][1]]}}this.updateRange(H[0]);this.updateRange(H[2])};v.prototype.savePrivateValues=function(A){};v.prototype.manipulateWindow=function(A){};
v.prototype.reverseAttrInRectangle=function(A){};v.prototype.setTitleModeFeature=function(A){};v.prototype.setWarningBellVolume=function(A){};v.prototype.setMarginBellVolume=function(A){};v.prototype.copyRectangle=function(A){};v.prototype.enableFilterRectangle=function(A){};v.prototype.requestParameters=function(A){};v.prototype.selectChangeExtent=function(A){};v.prototype.fillRectangle=function(H){var F=H[0],E=H[1],C=H[2],A=H[3],G=H[4];var B,D;for(;E<A+1;E++){B=this.lines[this.ybase+E];for(D=C;D<G;D++){B[D]=[B[D][0],w.fromCharCode(F)]}}this.updateRange(H[1]);this.updateRange(H[3])};v.prototype.enableLocatorReporting=function(B){var A=B[0]>0};v.prototype.eraseRectangle=function(H){var E=H[0],C=H[1],A=H[2],G=H[3];var B,D,F;F=[this.eraseAttr()," "];for(;E<A+1;E++){B=this.lines[this.ybase+E];for(D=C;D<G;D++){B[D]=F}}this.updateRange(H[0]);this.updateRange(H[2])};v.prototype.setLocatorEvents=function(A){};v.prototype.selectiveEraseRectangle=function(A){};v.prototype.requestLocatorPosition=function(A){};v.prototype.insertColumns=function(){var D=params[0],A=this.ybase+this.rows,C=[this.eraseAttr()," "],B;while(D--){for(B=this.ybase;B<A;B++){this.lines[B].splice(this.x+1,0,C);this.lines[B].pop()}}this.maxRange()};v.prototype.deleteColumns=function(){var D=params[0],A=this.ybase+this.rows,C=[this.eraseAttr()," "],B;while(D--){for(B=this.ybase;B<A;B++){this.lines[B].splice(this.x,1);this.lines[B].push(C)}}this.maxRange()};v.prototype.enterPrefix=function(){this.prefixMode=true};v.prototype.leavePrefix=function(){this.prefixMode=false};v.prototype.enterSelect=function(){this._real={x:this.x,y:this.y,ydisp:this.ydisp,ybase:this.ybase,cursorHidden:this.cursorHidden,lines:this.copyBuffer(this.lines),write:this.write};this.write=function(){};this.selectMode=true;this.visualMode=false;this.cursorHidden=false;this.refresh(this.y,this.y)};v.prototype.leaveSelect=function(){this.x=this._real.x;this.y=this._real.y;this.ydisp=this._real.ydisp;this.ybase=this._real.ybase;this.cursorHidden=this._real.cursorHidden;this.lines=this._real.lines;this.write=this._real.write;delete this._real;this.selectMode=false;this.visualMode=false;this.refresh(0,this.rows-1)};v.prototype.enterVisual=function(){this._real.preVisual=this.copyBuffer(this.lines);this.selectText(this.x,this.x,this.ydisp+this.y,this.ydisp+this.y);this.visualMode=true};v.prototype.leaveVisual=function(){this.lines=this._real.preVisual;delete this._real.preVisual;delete this._selected;this.visualMode=false;this.refresh(0,this.rows-1)};v.prototype.enterSearch=function(C){this.entry="";this.searchMode=true;this.searchDown=C;this._real.preSearch=this.copyBuffer(this.lines);this._real.preSearchX=this.x;this._real.preSearchY=this.y;var A=this.ydisp+this.rows-1;for(var B=0;B<this.entryPrefix.length;B++){this.lines[A][B]=[(this.defAttr&~511)|4,this.entryPrefix[B]]}this.y=this.rows-1;this.x=this.entryPrefix.length;this.refresh(this.rows-1,this.rows-1)};v.prototype.leaveSearch=function(){this.searchMode=false;if(this._real.preSearch){this.lines=this._real.preSearch;this.x=this._real.preSearchX;this.y=this._real.preSearchY;delete this._real.preSearch;delete this._real.preSearchX;delete this._real.preSearchY}this.refresh(this.rows-1,this.rows-1)};v.prototype.copyBuffer=function(B){var B=B||this.lines,C=[];for(var D=0;D<B.length;D++){C[D]=[];for(var A=0;A<B[D].length;A++){C[D][A]=[B[D][A][0],B[D][A][1]]}}return C};v.prototype.getCopyTextarea=function(C){var B=this._copyTextarea,A=this.document;if(!B){B=A.createElement("textarea");B.style.position="absolute";B.style.left="-32000px";B.style.top="-32000px";B.style.width="0px";B.style.height="0px";B.style.opacity="0";B.style.backgroundColor="transparent";B.style.borderStyle="none";B.style.outlineStyle="none";A.getElementsByTagName("body")[0].appendChild(B);this._copyTextarea=B}return B};v.prototype.copyText=function(C){var B=this,A=this.getCopyTextarea();this.emit("copy",C);A.focus();A.textContent=C;A.value=C;A.setSelectionRange(0,C.length);b(function(){B.element.focus();B.focus()},1)};v.prototype.selectText=function(B,A,K,I){var D,C,M,L,E,J,H,F,G;if(this._selected){D=this._selected.x1;C=this._selected.x2;M=this._selected.y1;L=this._selected.y2;if(L<M){E=C;C=D;D=E;E=L;L=M;M=E}if(C<D&&M===L){E=C;C=D;D=E}for(H=M;H<=L;H++){J=0;F=this.cols-1;if(H===M){J=D}if(H===L){F=C}for(;J<=F;J++){if(this.lines[H][J].old!=null){G=this.lines[H][J].old;delete this.lines[H][J].old;this.lines[H][J]=[G,this.lines[H][J][1]]}}}K=this._selected.y1;B=this._selected.x1}K=Math.max(K,0);K=Math.min(K,this.ydisp+this.rows-1);I=Math.max(I,0);I=Math.min(I,this.ydisp+this.rows-1);this._selected={x1:B,x2:A,y1:K,y2:I};if(I<K){E=A;A=B;B=E;E=I;I=K;K=E}if(A<B&&K===I){E=A;A=B;B=E}for(H=K;H<=I;H++){J=0;F=this.cols-1;if(H===K){J=B}if(H===I){F=A}for(;J<=F;J++){G=this.lines[H][J][0];this.lines[H][J]=[(G&~511)|((511<<9)|4),this.lines[H][J][1]];this.lines[H][J].old=G}}K=K-this.ydisp;I=I-this.ydisp;K=Math.max(K,0);K=Math.min(K,this.rows-1);I=Math.max(I,0);I=Math.min(I,this.rows-1);this.refresh(0,this.rows-1)
};v.prototype.grabText=function(C,B,J,I){var E="",D="",A,K,H,G,F;if(I<J){F=B;B=C;C=F;F=I;I=J;J=F}if(B<C&&J===I){F=B;B=C;C=F}for(H=J;H<=I;H++){K=0;G=this.cols-1;if(H===J){K=C}if(H===I){G=B}for(;K<=G;K++){A=this.lines[H][K][1];if(A===" "){D+=A;continue}if(D){E+=D;D=""}E+=A;if(t(A)){K++}}D="";E+="\n"}for(K=B,H=I;K<this.cols;K++){if(this.lines[H][K][1]!==" "){E=E.slice(0,-1);break}}return E};v.prototype.keyPrefix=function(B,A){if(A==="k"||A==="&"){this.destroy()}else{if(A==="p"||A==="]"){this.emit("request paste")}else{if(A==="c"){this.emit("request create")}else{if(A>="0"&&A<="9"){A=+A-1;if(!~A){A=9}this.emit("request term",A)}else{if(A==="n"){this.emit("request term next")}else{if(A==="P"){this.emit("request term previous")}else{if(A===":"){this.emit("request command mode")}else{if(A==="["){this.enterSelect()}}}}}}}}};v.prototype.keySelect=function(I,K){this.showCursor();if(this.searchMode||K==="n"||K==="N"){return this.keySearch(I,K)}if(K==="\x04"){var H=this.ydisp+this.y;if(this.ydisp===this.ybase){this.y=Math.min(this.y+(this.rows-1)/2|0,this.rows-1);this.refresh(0,this.rows-1)}else{this.scrollDisp((this.rows-1)/2|0)}if(this.visualMode){this.selectText(this.x,this.x,H,this.ydisp+this.y)}return}if(K==="\x15"){var H=this.ydisp+this.y;if(this.ydisp===0){this.y=Math.max(this.y-(this.rows-1)/2|0,0);this.refresh(0,this.rows-1)}else{this.scrollDisp(-(this.rows-1)/2|0)}if(this.visualMode){this.selectText(this.x,this.x,H,this.ydisp+this.y)}return}if(K==="\x06"){var H=this.ydisp+this.y;this.scrollDisp(this.rows-1);if(this.visualMode){this.selectText(this.x,this.x,H,this.ydisp+this.y)}return}if(K==="\x02"){var H=this.ydisp+this.y;this.scrollDisp(-(this.rows-1));if(this.visualMode){this.selectText(this.x,this.x,H,this.ydisp+this.y)}return}if(K==="k"||K==="\x1b[A"){var H=this.ydisp+this.y;this.y--;if(this.y<0){this.y=0;this.scrollDisp(-1)}if(this.visualMode){this.selectText(this.x,this.x,H,this.ydisp+this.y)}else{this.refresh(this.y,this.y+1)}return}if(K==="j"||K==="\x1b[B"){var H=this.ydisp+this.y;this.y++;if(this.y>=this.rows){this.y=this.rows-1;this.scrollDisp(1)}if(this.visualMode){this.selectText(this.x,this.x,H,this.ydisp+this.y)}else{this.refresh(this.y-1,this.y)}return}if(K==="h"||K==="\x1b[D"){var J=this.x;this.x--;if(this.x<0){this.x=0}if(this.visualMode){this.selectText(J,this.x,this.ydisp+this.y,this.ydisp+this.y)}else{this.refresh(this.y,this.y)}return}if(K==="l"||K==="\x1b[C"){var J=this.x;this.x++;if(this.x>=this.cols){this.x=this.cols-1}if(this.visualMode){this.selectText(J,this.x,this.ydisp+this.y,this.ydisp+this.y)}else{this.refresh(this.y,this.y)}return}if(K==="v"||K===" "){if(!this.visualMode){this.enterVisual()}else{this.leaveVisual()}return}if(K==="y"){if(this.visualMode){var M=this.grabText(this._selected.x1,this._selected.x2,this._selected.y1,this._selected.y2);this.copyText(M);this.leaveVisual()}return}if(K==="q"||K==="\x1b"){if(this.visualMode){this.leaveVisual()}else{this.leaveSelect()}return}if(K==="w"||K==="W"){var C=this.x;var B=this.y;var G=this.ydisp;var J=this.x;var H=this.y;var F=this.ydisp;var A=false;for(;;){var O=this.lines[F+H];while(J<this.cols){if(O[J][1]<=" "){A=true}else{if(A){break}}J++}if(J>=this.cols){J=this.cols-1}if(J===this.cols-1&&O[J][1]<=" "){J=0;if(++H>=this.rows){H--;if(++F>this.ybase){F=this.ybase;J=this.x;break}}continue}break}this.x=J,this.y=H;this.scrollDisp(-this.ydisp+F);if(this.visualMode){this.selectText(C,this.x,B+G,this.ydisp+this.y)}return}if(K==="b"||K==="B"){var C=this.x;var B=this.y;var G=this.ydisp;var J=this.x;var H=this.y;var F=this.ydisp;for(;;){var O=this.lines[F+H];var A=J>0&&O[J][1]>" "&&O[J-1][1]>" ";while(J>=0){if(O[J][1]<=" "){if(A&&(J+1<this.cols&&O[J+1][1]>" ")){J++;break}else{A=true}}J--}if(J<0){J=0}if(J===0&&(O[J][1]<=" "||!A)){J=this.cols-1;if(--H<0){H++;if(--F<0){F++;J=0;break}}continue}break}this.x=J,this.y=H;this.scrollDisp(-this.ydisp+F);if(this.visualMode){this.selectText(C,this.x,B+G,this.ydisp+this.y)}return}if(K==="e"||K==="E"){var J=this.x+1;var H=this.y;var F=this.ydisp;if(J>=this.cols){J--}for(;;){var O=this.lines[F+H];while(J<this.cols){if(O[J][1]<=" "){J++}else{break}}while(J<this.cols){if(O[J][1]<=" "){if(J-1>=0&&O[J-1][1]>" "){J--;break}}J++}if(J>=this.cols){J=this.cols-1}if(J===this.cols-1&&O[J][1]<=" "){J=0;if(++H>=this.rows){H--;if(++F>this.ybase){F=this.ybase;break}}continue}break}this.x=J,this.y=H;this.scrollDisp(-this.ydisp+F);if(this.visualMode){this.selectText(C,this.x,B+G,this.ydisp+this.y)}return}if(K==="^"||K==="0"){var C=this.x;if(K==="0"){this.x=0}else{if(K==="^"){var O=this.lines[this.ydisp+this.y];var J=0;while(J<this.cols){if(O[J][1]>" "){break}J++}if(J>=this.cols){J=this.cols-1}this.x=J}}if(this.visualMode){this.selectText(C,this.x,this.ydisp+this.y,this.ydisp+this.y)}else{this.refresh(this.y,this.y)}return}if(K==="$"){var C=this.x;var O=this.lines[this.ydisp+this.y];var J=this.cols-1;while(J>=0){if(O[J][1]>" "){if(this.visualMode&&J<this.cols-1){J++}break}J--}if(J<0){J=0}this.x=J;if(this.visualMode){this.selectText(C,this.x,this.ydisp+this.y,this.ydisp+this.y)
}else{this.refresh(this.y,this.y)}return}if(K==="g"||K==="G"){var C=this.x;var B=this.y;var G=this.ydisp;if(K==="g"){this.x=0,this.y=0;this.scrollDisp(-this.ydisp)}else{if(K==="G"){this.x=0,this.y=this.rows-1;this.scrollDisp(this.ybase)}}if(this.visualMode){this.selectText(C,this.x,B+G,this.ydisp+this.y)}return}if(K==="H"||K==="M"||K==="L"){var C=this.x;var B=this.y;if(K==="H"){this.x=0,this.y=0}else{if(K==="M"){this.x=0,this.y=this.rows/2|0}else{if(K==="L"){this.x=0,this.y=this.rows-1}}}if(this.visualMode){this.selectText(C,this.x,this.ydisp+B,this.ydisp+this.y)}else{this.refresh(B,B);this.refresh(this.y,this.y)}return}if(K==="{"||K==="}"){var C=this.x;var B=this.y;var G=this.ydisp;var O;var L=false;var N=false;var D=-1;var H=this.y+(K==="{"?-1:1);var F=this.ydisp;var E;if(K==="{"){if(H<0){H++;if(F>0){F--}}}else{if(K==="}"){if(H>=this.rows){H--;if(F<this.ybase){F++}}}}for(;;){O=this.lines[F+H];for(E=0;E<this.cols;E++){if(O[E][1]>" "){if(D===-1){D=0}L=true;break}else{if(E===this.cols-1){if(D===-1){D=1}else{if(D===0){N=true}else{if(D===1){if(L){N=true}}}}break}}}if(N){break}if(K==="{"){H--;if(H<0){H++;if(F>0){F--}else{break}}}else{if(K==="}"){H++;if(H>=this.rows){H--;if(F<this.ybase){F++}else{break}}}}}if(!N){if(K==="{"){H=0;F=0}else{if(K==="}"){H=this.rows-1;F=this.ybase}}}this.x=0,this.y=H;this.scrollDisp(-this.ydisp+F);if(this.visualMode){this.selectText(C,this.x,B+G,this.ydisp+this.y)}return}if(K==="/"||K==="?"){if(!this.visualMode){this.enterSearch(K==="/")}return}return false};v.prototype.keySearch=function(J,M){if(M==="\x1b"){this.leaveSearch();return}if(M==="\r"||(!this.searchMode&&(M==="n"||M==="N"))){this.leaveSearch();var L=this.entry;if(!L){this.refresh(0,this.rows-1);return}var C=this.x;var B=this.y;var H=this.ydisp;var O;var N=false;var G=false;var K=this.x+1;var I=this.ydisp+this.y;var F,E;var D=M==="N"?this.searchDown:!this.searchDown;for(;;){O=this.lines[I];while(K<this.cols){for(E=0;E<L.length;E++){if(K+E>=this.cols){break}if(O[K+E][1]!==L[E]){break}else{if(O[K+E][1]===L[E]&&E===L.length-1){N=true;break}}}if(N){break}K+=E+1}if(N){break}K=0;if(!D){I++;if(I>this.ybase+this.rows-1){if(G){break}G=true;I=0}}else{I--;if(I<0){if(G){break}G=true;I=this.ybase+this.rows-1}}}if(N){if(I-this.ybase<0){F=I;I=0;if(F>this.ybase){I=F-this.ybase;F=this.ybase}}else{F=this.ybase;I-=this.ybase}this.x=K,this.y=I;this.scrollDisp(-this.ydisp+F);if(this.visualMode){this.selectText(C,this.x,B+H,this.ydisp+this.y)}return}this.refresh(0,this.rows-1);return}if(M==="\b"||M==="\x7f"){if(this.entry.length===0){return}var A=this.ydisp+this.rows-1;this.entry=this.entry.slice(0,-1);var E=this.entryPrefix.length+this.entry.length;this.lines[A][E]=[this.lines[A][E][0]," "];this.x--;this.refresh(this.rows-1,this.rows-1);this.refresh(this.y,this.y);return}if(M.length===1&&M>=" "&&M<="~"){var A=this.ydisp+this.rows-1;this.entry+=M;var E=this.entryPrefix.length+this.entry.length-1;this.lines[A][E]=[(this.defAttr&~511)|4,M];this.x++;this.refresh(this.rows-1,this.rows-1);this.refresh(this.y,this.y);return}return false};v.charsets={};v.charsets.SCLD={"`":"\u25c6","a":"\u2592","b":"\u0009","c":"\u000c","d":"\u000d","e":"\u000a","f":"\u00b0","g":"\u00b1","h":"\u2424","i":"\u000b","j":"\u2518","k":"\u2510","l":"\u250c","m":"\u2514","n":"\u253c","o":"\u23ba","p":"\u23bb","q":"\u2500","r":"\u23bc","s":"\u23bd","t":"\u251c","u":"\u2524","v":"\u2534","w":"\u252c","x":"\u2502","y":"\u2264","z":"\u2265","{":"\u03c0","|":"\u2260","}":"\u00a3","~":"\u00b7"};v.charsets.UK=null;v.charsets.US=null;v.charsets.Dutch=null;v.charsets.Finnish=null;v.charsets.French=null;v.charsets.FrenchCanadian=null;v.charsets.German=null;v.charsets.Italian=null;v.charsets.NorwegianDanish=null;v.charsets.Spanish=null;v.charsets.Swedish=null;v.charsets.Swiss=null;v.charsets.ISOLatin=null;function l(D,C,B,A){D.addEventListener(C,B,A||false)}function y(D,C,B,A){D.removeEventListener(C,B,A||false)}function d(A){if(A.preventDefault){A.preventDefault()}A.returnValue=false;if(A.stopPropagation){A.stopPropagation()}A.cancelBubble=true;return false}function m(C,A){function B(){this.constructor=C}B.prototype=A.prototype;C.prototype=new B}function x(C){var B=C.getElementsByTagName("body")[0];var F=C.createElement("div");F.className="terminal";var E=C.createElement("div");var G=C.createElement("span");G.innerHTML="hello world";E.appendChild(G);F.appendChild(E);B.appendChild(F);var D=G.scrollWidth;G.style.fontWeight="bold";var A=G.scrollWidth;B.removeChild(F);return D!==A}var w=this.String;var b=this.setTimeout;var a=this.setInterval;function c(C,B){var A=C.length;while(A--){if(C[A]===B){return A}}return -1}function t(A){if(A<="\uff00"){return false}return(A>="\uff01"&&A<="\uffbe")||(A>="\uffc2"&&A<="\uffc7")||(A>="\uffca"&&A<="\uffcf")||(A>="\uffd2"&&A<="\uffd7")||(A>="\uffda"&&A<="\uffdc")||(A>="\uffe0"&&A<="\uffe6")||(A>="\uffe8"&&A<="\uffee")}function n(C,A,I){var D=(C<<16)|(A<<8)|I;if(n._cache[D]!=null){return n._cache[D]}var E=Infinity,K=-1,F=0,G,B,L,H,J;for(;F<v.vcolors.length;
F++){G=v.vcolors[F];B=G[0];L=G[1];H=G[2];J=n.distance(C,A,I,B,L,H);if(J===0){K=F;break}if(J<E){E=J;K=F}}return n._cache[D]=K}n._cache={};n.distance=function(E,D,F,B,A,C){return Math.pow(30*(E-B),2)+Math.pow(59*(D-A),2)+Math.pow(11*(F-C),2)};function f(D,B,A){if(D.forEach){return D.forEach(B,A)}for(var C=0;C<D.length;C++){B.call(A,D[C],C,D)}}function o(C){if(Object.keys){return Object.keys(C)}var A,B=[];for(A in C){if(Object.prototype.hasOwnProperty.call(C,A)){B.push(A)}}return B}v.EventEmitter=i;v.Stream=e;v.inherits=m;v.on=l;v.off=y;v.cancel=d;if(typeof module!=="undefined"){module.exports=v}else{this.Terminal=v}}).call(function(){return this||(typeof window!=="undefined"?window:global)}());